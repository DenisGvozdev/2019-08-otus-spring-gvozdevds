<!doctype html>
<!--[if lt IE 7 ]>
<html lang="en" class="ie6"> <![endif]-->
<!--[if IE 7 ]>
<html lang="en" class="ie7"> <![endif]-->
<!--[if IE 8 ]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9 ]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml"> <!--<![endif]-->
<head>
    <meta charset="utf-8" name="viewport" content="width = 1050, user-scalable = no"/>
    <script type="text/javascript" src="extras/jquery.min.1.7.js"></script>
    <script type="text/javascript" src="extras/modernizr.2.5.3.min.js"></script>
</head>
<body>

<div class="flipbook-viewport">
    <div class="container">
        <div class="flipbook"></div>
    </div>
</div>

<div id="book" th:text="${book}" hidden></div>

<script type="text/javascript">

    $(document).ready(function () {

        // document.oncontextmenu = function () {
        //     return false
        // };

        var book = JSON.parse($("#book")[0].textContent);
        var pageList = book.pageList;

        $.each(pageList, function (key, value) {

            var image = value.image;
            var text = value.text;
            var page = value.page;

            if (image != null) {
                var divImage = "<div style=\"background-image:url(data:image/png;base64," + image + ")\"></div>";
                $(".flipbook").append(divImage);

            } else if (text != null) {
                var divText = "<div>" +
                    "<table style='height: 100%; width: 100%;'>" +
                    "   <tr style='height: 90%; width: 100%'>" +
                    "       <td style='text-align: justify; padding: 20px 20px 20px 20px'>" + text + "</td>" +
                    "    </tr>" +
                    "   <tr style='height: 10%; width: 100%;'>" +
                    "       <td style='text-align: center'>" + page + "</td>" +
                    "    </tr>" +
                    "</table>" +
                    "</div>";

                $(".flipbook").append(divText);
            }
        });
        loadApp();

    });

    function loadApp() {
        $('.flipbook').turn({
            width: 922,
            height: 600,
            elevation: 50,
            gradients: true,
            autoCenter: true
        });
    }

    yepnope({
        test: Modernizr.csstransforms,
        yep: ['lib/turn.js'],
        nope: ['lib/turn.html4.min.js'],
        both: ['css/basic.css'],
        complete: loadApp
    });

</script>
</body>
</html>